<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:QuadroApp.ViewModels"
    xmlns:m="using:QuadroApp.Model.DB"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:design="clr-namespace:Avalonia.Markup.Xaml;assembly=Avalonia.Markup"
    xmlns:conv="using:QuadroApp.Converters"
    x:Class="QuadroApp.Views.WerkBonLijstView"
    x:DataType="vm:WerkBonLijstViewModel"
    d:DataContext="{d:DesignInstance vm:WerkBonLijstViewModel, IsDesignTimeCreatable=True}"
    Background="#F5F5F5">

	<!-- Resources (zelfde als LijstenView) -->
	<UserControl.Resources>
		<conv:BoolToThicknessConverter x:Key="BoolToThicknessSlide"
									   WhenTrue="0"
									   WhenFalse="520,0,-520,0"/>
		<conv:BoolToDoubleConverter x:Key="BoolToOpacity"
									WhenTrue="1"
									WhenFalse="0"/>
	</UserControl.Resources>

	<Grid RowDefinitions="Auto,*">

		<!-- HEADER -->
		<Border Grid.Row="0" Background="#444A50" Height="70">
			<DockPanel Margin="20,0">

				<StackPanel DockPanel.Dock="Left"
							Orientation="Horizontal"
							VerticalAlignment="Center"
							Spacing="10">
					<Ellipse Width="35" Height="35" Fill="#F5C242"/>
					<TextBlock Text="QUADRO"
							   FontSize="20"
							   FontWeight="Bold"
							   Foreground="White"/>
					<TextBlock Text="WERKBONNEN"
							   FontSize="13"
							   Foreground="#CCC"
							   Margin="20,0,0,0"/>
				</StackPanel>

				<Button Content="â¬…ï¸ Terug"
						Command="{Binding GaTerugCommand}"
						DockPanel.Dock="Right"
						VerticalAlignment="Top"
						HorizontalAlignment="Right"
						Margin="0,10,10,0"
						Background="#F5C242"
						Foreground="#222"
						FontWeight="Bold"
						CornerRadius="8"
						Padding="10,5"
						Width="100"
						Height="32"/>
			</DockPanel>
		</Border>

		<!-- MAIN -->
		<Grid Grid.Row="1"
			  Margin="20"
			  ColumnDefinitions="*,Auto"
			  ColumnSpacing="20">

			<!-- LINKS -->
			<ScrollViewer Grid.Column="0"
						  VerticalScrollBarVisibility="Auto"
						  HorizontalScrollBarVisibility="Disabled">

				<StackPanel Spacing="14">

					<TextBlock Text="ðŸ§¾ Werkbonnen"
							   FontSize="22"
							   FontWeight="Bold"/>

					<!-- Search + tools -->
					<Grid ColumnDefinitions="Auto,Auto" ColumnSpacing="10">

						<TextBox Grid.Column="0"
								 Width="280"
								 Height="34"
								 Watermark="Zoek op bonnr of klantâ€¦"
								 Text="{Binding Zoekterm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

						<StackPanel Grid.Column="1"
									Orientation="Horizontal"
									Spacing="6"
									VerticalAlignment="Center">
							<Button Content="ðŸ”„"
									ToolTip.Tip="Ververs"
									Command="{Binding RefreshCommand}"
									Classes="IconBtn"/>
							<Button Content="ðŸ“…"
									ToolTip.Tip="Open planning"
									Command="{Binding OpenPlanningCommand}"
									Classes="IconBtn"/>
						</StackPanel>

					</Grid>

					<!-- Headers -->
					<Grid ColumnDefinitions="0.7*,1.8*,1.2*,1.3*">
						<TextBlock Text="Bon" Grid.Column="0" FontWeight="Bold" TextAlignment="Center"/>
						<TextBlock Text="Klant" Grid.Column="1" FontWeight="Bold" TextAlignment="Center"/>
						<TextBlock Text="Status" Grid.Column="2" FontWeight="Bold" TextAlignment="Center"/>
						<TextBlock Text="Aangemaakt" Grid.Column="3" FontWeight="Bold" TextAlignment="Center"/>
					</Grid>

					<Border Background="White"
							BorderBrush="#DDD"
							BorderThickness="1"
							CornerRadius="8"
							Padding="4">

						<ListBox ItemsSource="{Binding WerkBonnen}"
								 SelectedItem="{Binding SelectedWerkBon, Mode=TwoWay}"
								 BorderThickness="0"
								 Background="Transparent">

							<ListBox.Styles>
								<Style Selector="ListBoxItem">
									<Setter Property="CornerRadius" Value="6"/>
									<Setter Property="Margin" Value="0,0,0,6"/>
									<Setter Property="Padding" Value="8"/>
								</Style>
								<Style Selector="ListBoxItem:pointerover">
									<Setter Property="Background" Value="#FFF8E1"/>
								</Style>
								<Style Selector="ListBoxItem:selected">
									<Setter Property="Background" Value="#FFECB3"/>
									<Setter Property="BorderBrush" Value="#F5C242"/>
									<Setter Property="BorderThickness" Value="1"/>
								</Style>
							</ListBox.Styles>

							<ListBox.ItemTemplate>
								<DataTemplate x:DataType="m:WerkBon">
									<Grid ColumnDefinitions="0.7*,1.8*,1.2*,1.3*">
										<TextBlock Grid.Column="0"
												   Text="{Binding Id}"
												   FontWeight="Bold"
												   TextAlignment="Center"/>
										<TextBlock Grid.Column="1"
												   Text="{Binding Offerte.Klant.Achternaam}"
												   TextAlignment="Center"/>
										<TextBlock Grid.Column="2"
												   Text="{Binding Status}"
												   TextAlignment="Center"/>
										<TextBlock Grid.Column="3"
												   Text="{Binding AangemaaktOp, StringFormat='dd/MM/yyyy'}"
												   TextAlignment="Center"/>
									</Grid>
								</DataTemplate>
							</ListBox.ItemTemplate>

						</ListBox>
					</Border>

					<TextBlock Text="{Binding WerkBonnen.Count, StringFormat='Aantal werkbonnen: {0}'}"
							   Foreground="#666"
							   HorizontalAlignment="Center"/>

				</StackPanel>
			</ScrollViewer>

			<!-- DETAIL PANEL -->
			<Border Grid.Column="1"
					Width="520"
					Padding="24"
					Background="White"
					CornerRadius="10"
					BorderBrush="#E0E0E0"
					BorderThickness="1"
					IsHitTestVisible="{Binding IsDetailOpen}">

				<Border.Transitions>
					<Transitions>
						<ThicknessTransition Property="Margin" Duration="0:0:0.2"/>
						<DoubleTransition Property="Opacity" Duration="0:0:0.2"/>
					</Transitions>
				</Border.Transitions>

				<Border.Margin>
					<Binding Path="IsDetailOpen" Converter="{StaticResource BoolToThicknessSlide}"/>
				</Border.Margin>
				<Border.Opacity>
					<Binding Path="IsDetailOpen" Converter="{StaticResource BoolToOpacity}"/>
				</Border.Opacity>

				<ScrollViewer VerticalScrollBarVisibility="Auto">
					<StackPanel Spacing="14">

						<TextBlock Text="ðŸ“Œ Werkbon details"
								   FontSize="22"
								   FontWeight="Bold"
								   Foreground="#222"/>

						<!-- Als niets geselecteerd -->
						<Border Background="#FFF8E1"
								CornerRadius="8"
								Padding="10"
								IsVisible="{Binding !IsDetailOpen}">
							<TextBlock Text="Selecteer links een werkbon om details te zien."
									   Foreground="#333"/>
						</Border>

						<!-- Details -->
						<StackPanel IsVisible="{Binding IsDetailOpen}" Spacing="16">

							<Grid ColumnDefinitions="2*,3*"
								  RowDefinitions="Auto,Auto,Auto,Auto"
								  RowSpacing="7"
								  ColumnSpacing="14">

								<TextBlock Text="Bon nr."
										   Grid.Row="0" Grid.Column="0"
										   FontWeight="Bold"/>
								<TextBlock Text="{Binding SelectedWerkBon.Id}"
										   Grid.Row="0" Grid.Column="1"/>

								<TextBlock Text="Klant"
										   Grid.Row="1" Grid.Column="0"
										   FontWeight="Bold"/>
								<TextBlock Text="{Binding SelectedWerkBon.Offerte.Klant.Achternaam}"
										   Grid.Row="1" Grid.Column="1"/>

								<TextBlock Text="Werkbon status"
										   Grid.Row="2" Grid.Column="0"
										   FontWeight="Bold"/>
								<ComboBox Grid.Row="2" Grid.Column="1"
										  ItemsSource="{Binding WerkBonStatusOpties}"
										  SelectedItem="{Binding SelectedWerkBonStatus, Mode=TwoWay}"/>

								<TextBlock Text="Offerte status"
										   Grid.Row="3" Grid.Column="0"
										   FontWeight="Bold"/>
								<ComboBox Grid.Row="3" Grid.Column="1"
										  ItemsSource="{Binding OfferteStatusOpties}"
										  SelectedItem="{Binding SelectedOfferteStatus, Mode=TwoWay}"/>
							</Grid>

							<StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Right">
								<Button Content="ðŸ’¾ Opslaan status"
										Command="{Binding SaveStatusCommand}"
										Classes="MainBtn"
										Padding="12,6"/>
								<Button Content="â†©ï¸ Offerte terug zichtbaar"
										Command="{Binding MaakOfferteTerugZichtbaarCommand}"
										Classes="MainBtn"
										Padding="12,6"/>
							</StackPanel>

							<TextBlock Text="ðŸ›  WerkTaken"
									   FontSize="18"
									   FontWeight="SemiBold"
									   Foreground="#222"/>

							<Border Background="#FAFAFA"
									BorderBrush="#DDD"
									BorderThickness="1"
									CornerRadius="8"
									Padding="6">

								<ListBox ItemsSource="{Binding SelectedWerkBonTaken}"
										 BorderThickness="0"
										 Background="Transparent">
									<ListBox.ItemTemplate>
										<DataTemplate x:DataType="m:WerkTaak">
											<Border Background="White"
													CornerRadius="8"
													BorderBrush="#EEE"
													BorderThickness="1"
													Padding="10"
													Margin="0,0,0,8">
												<StackPanel Spacing="4">
													<TextBlock Text="{Binding Omschrijving}" FontWeight="Bold"/>
													<TextBlock Text="{Binding DuurMinuten, StringFormat='Duur: {0} min'}" Foreground="#666"/>
													<TextBlock Text="{Binding GeplandVan, StringFormat='Van: {0:dd/MM HH:mm}'}" Foreground="#666"/>
													<TextBlock Text="{Binding GeplandTot, StringFormat='Tot: {0:dd/MM HH:mm}'}" Foreground="#666"/>
													<TextBlock Text="{Binding OfferteRegel.TypeLijst.Artikelnummer, StringFormat='Lijst: {0}'}"
															   Foreground="#666"/>
												</StackPanel>
											</Border>
										</DataTemplate>
									</ListBox.ItemTemplate>
								</ListBox>
							</Border>

						</StackPanel>
					</StackPanel>
				</ScrollViewer>
			</Border>

		</Grid>
	</Grid>

	<!-- Styles: dezelfde als jouw LijstenView -->
	<UserControl.Styles>

		<Style Selector="Button.MainBtn">
			<Setter Property="Background" Value="#444A50"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="CornerRadius" Value="8"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="FontSize" Value="15"/>
			<Setter Property="Padding" Value="10,5"/>
		</Style>
		<Style Selector="Button.MainBtn:pointerover">
			<Setter Property="Background" Value="#F5C242"/>
			<Setter Property="Foreground" Value="#222"/>
		</Style>

		<Style Selector="Button.IconBtn">
			<Setter Property="Width" Value="40"/>
			<Setter Property="Height" Value="40"/>
			<Setter Property="FontSize" Value="18"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Background" Value="#444A50"/>
			<Setter Property="Foreground" Value="White"/>
			<Setter Property="FontWeight" Value="Bold"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="Margin" Value="2"/>
		</Style>
		<Style Selector="Button.IconBtn:pointerover">
			<Setter Property="Background" Value="#F5C242"/>
			<Setter Property="Foreground" Value="#222"/>
		</Style>

		<Style Selector="TextBlock">
			<Setter Property="Foreground" Value="Black"/>
		</Style>
	</UserControl.Styles>

</UserControl>